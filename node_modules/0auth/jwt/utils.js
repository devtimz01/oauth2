function base64urlDecode(str) {
  return Buffer.from(base64urlUnescape(str), "base64").toString();
}

function base64urlUnescape(str) {
  str += new Array(5 - (str.length % 4)).join("=");
  return str.replace(/\-/g, "+").replace(/_/g, "/");
}

function cookieParser(req) {
  req.cookies = req.headers.cookie
    ? req.headers.cookie.split("; ").reduce((acc, el) => {
        const [name, value] = el.split("=");
        acc[name] = value;
        return acc;
      }, {})
    : null;
}

module.exports = { base64urlUnescape, base64urlDecode, cookieParser };
